---
title: "ABM approach to Game Theory"
author: "Dmitrii Rykunov"
date: "24 June 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r loading_functions, include=FALSE}
source("R/load.R", echo = FALSE)
```

## Concurrent Multi-Agent Optimization
Данная работа исследует **новый тип эволюционных алгоритмов** - предоставляющих возможности для поиска равновесных состояний агентных систем, отражающих **стратегические задачи**.
В ходе исследования был разработан пример такого алгоритма для поиска равновесных состояний в задачах, которые могут быть представлены **играми в нормальной форме** (в традиции теории игр).

Представленный ниже **алгоритм является** по своей природе **стохастическим** алгоритмом оптимизации, и потому при наличии нескольких равновесных сотояний (оптимумов) алгоритм приходит к одному из них в зависимости **от исходного состояния** системы (отправной точки для оптимизации).

### Демонстрация алгоритма
*Далее используется программный код, написанный на R, и представленный в общем доступе https://github.com/drykunov/ABMgt *

#### Структура алгоритма:
1. В игровой ситуации выделяются типы игроков (игрок номер 1, игрок номер 2 и тд.)
2. Для каждого типа игроков создается независимая популяция (набор/суб-популяция) стратегий, отражающая данный тип игрока
3. Эти популяции параллельно эволюционируют
    + "Успешность" каждого отдельного представителя каждой суб-популяции рассчитывается в симуляциях с участием текущих (того же поколения) представителей всех суб-популяций
    + Каждая суб-популяция сортируется по накопленному в данном поколении игровому счету
    + Худшие представители заменяются стохастически измененными лучшими (добавлением нормально распределенной случайной величины)

#### Proof-of-Concept

##### Bach or Stravinsky
Формирование отправной точки для симуляции игры BoS:
```{r demo_BoS_sim_init, cache=TRUE}
set.seed(444)
gm <- GM$BoS
sim <- CreateSimulation(generations = 20, nGames = 30, popSize = 60, gameModel = gm)
sim
```
Результат оптимизации через 15 поколений:
```{r demo_BoS_sim_calc, cache=TRUE, results='hide'}
set.seed(444)
sim <- RunSimulation(sim, iterations = 15)
```
```{r demo_BoS_sim_print, cache=TRUE}
sim$population
```

*Итоговая популяция уже отсортирована по игровому счету последнего поколения.*

Как мы видим, результат очень близок к одному из равновесий игры **((0, 1), (0, 1, 0)) (i.e. the pure strategy equilibrium (S, S))**

##### Prisoners Dilemma

```{r demo_PD_sim_init, cache=TRUE}
set.seed(1337)
gm <- GM$prisoners_dilemma
simPD <- CreateSimulation(generations = 20, nGames = 30, popSize = 60, gameModel = gm)
simPD
```
Результат оптимизации через 15 поколений:
```{r demo_PD_sim_calc, cache=TRUE, results='hide'}
set.seed(808)
simPD <- RunSimulation(simPD, iterations = 15)
```
```{r demo_PD_sim_print, cache=TRUE}
simPD$population
```

### Multimodal Optimization

**Для поиска всех равновесных состояний** предлагается подход, который может быть классифицирован как **Iterated Local Search** *(p. 60, Preuss, M. (2015). Multimodal Optimization by Means of Evolutionary Algorithms. Springer International Publishing Switzerland)*.

Для его реализации необходимо решить три задачи:

1. Определение потенциального равновесного состояния
2. Фиксация равновесных состояний
3. Предотвращение избыточного поиска уже зафиксированных равновесных состояний

Для решения поставленных задач предлагаются следующие подходы соответственно:

1. Рассчет Stability Measure аналогично представленному в работе *(p. 1971, Lung, Chira, Dumitrescu, An Agent-Based Collaborative Evolutionary Model for Multimodal Optimization, GECCO’08, July 12–16, 2008, Atlanta, Georgia, USA)*
2. Тестирование потенциальных равновесных состояний
    + На истинность - посредством запуска симуляции (без дополнительных ограничений) из отправной точки состоящей целиком из стратегий, соответствующим предполагаемому равновесному состоянию. Если оно истинно, система останется в нем, если нет - сместится в ближайшее равновесие. (контрольными показателями здесь могут являться Stability Measure (см. пункт 1) и Distance Metric (посчитанная по общему для всех типов агентов пространству стратегий))
    + На новизну - исключает множественность зафиксированных наборов стратегий, соответствующих одному и тому же равновесию - потенциальное равновесное состояние сравнивается с имеющимися посредством расчета Distance Metric, либо использется подход Valley Detection *(p. 1972, Ibid)*
3. Исходя из зафиксированных равновесных состояний создаются искуственные искажения (дополнительные ограничения) в пространстве решений, аналогично подходу Fitness Sharing (for maintainance of diversity) на основе, например, Distance Metric. *(section 3.2, Zitzler, Laumanns, Bleuler, A Tutorial on Evolutionary Multiobjective Optimization)*
